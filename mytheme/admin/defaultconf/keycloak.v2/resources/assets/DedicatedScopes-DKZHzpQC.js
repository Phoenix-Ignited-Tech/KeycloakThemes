import{jsxs as b,jsx as e,Fragment as T}from"react/jsx-runtime";import{u as C,a as v,$ as R,bY as E,P as x,a_ as I,a$ as P,aR as F,bd as L,j as h,d as O,C as $,aQ as j,by as g,cS as w}from"./main-hZIJIVx9.js";import{useState as D}from"react";import{M as H}from"./MapperList-C9Go8WyH.js";import{R as N,u as V}from"./RoutableTabs-B1siEmtL.js";import{V as k}from"./ViewHeader-DxK8RzXz.js";import{u as G}from"./useParams-tGf6FJmU.js";import{F as K}from"./FormAccess-DIV7UK1Y.js";import{R as z}from"./AddRoleMappingModal-C4wZesy5.js";import{a as y,b as M}from"./Tabs-DXjNMDMz.js";import"react-dom";import"./useLocaleSort-Cjd-LyWL.js";import"./DataListItemRow-B1CYYhSa.js";import"./PageHandler-B0KkvOoM.js";import"./DynamicComponents-v6e2RtHb.js";import"./ClientSelect-9QE6UUYG.js";import"./FileUpload-DI2GSZLL.js";import"./CodeEditor-BZUGCa3z.js";import"./copy-icon-Cy7M-mD5.js";import"./GroupPickerDialog-CppD_q_3.js";import"./KeySelect-BUhUx10e.js";import"./useToggle-K3Kx99tM.js";import"./MultiLineInput-DThNyrNa.js";import"./PageList-DUHf6xan.js";import"./ConfirmDialog-BClP8m2C.js";import"./translationFormatter-QNso5xUZ.js";import"./filter-icon-B5V3NoWK.js";const B=({client:p})=>{const{adminClient:s}=C(),{t:r}=v(),{addAlert:l,addError:m}=R(),[t,f]=D(p),{hasAccess:a}=E(),u=a("manage-clients")||t.access?.manage,S=async c=>{try{const n=c.filter(i=>i.client===void 0).map(i=>i.role).flat();await Promise.all([s.clients.addRealmScopeMappings({id:t.id},n),...c.filter(i=>i.client!==void 0).map(i=>s.clients.addClientScopeMappings({id:t.id,client:i.client.id},[i.role]))]),l(r("clientScopeSuccess"),h.success)}catch(n){m("clientScopeError",n)}},A=async()=>{const c={...t,fullScopeAllowed:!t.fullScopeAllowed};try{await s.clients.update({id:t.id},c),l(r("clientScopeSuccess"),h.success),f(c)}catch(n){m("clientScopeError",n)}};return b(x,{children:[e(K,{role:"manage-clients",fineGrainedAccess:t.access?.manage,isHorizontal:!0,children:e(I,{hasNoPaddingTop:!0,label:r("fullScopeAllowed"),labelIcon:e(P,{helpText:r("fullScopeAllowedHelp"),fieldLabelId:"fullScopeAllowed"}),fieldId:"fullScopeAllowed",children:e(F,{id:"fullScopeAllowed",label:r("on"),labelOff:r("off"),isChecked:t.fullScopeAllowed,onChange:A,"aria-label":r("fullScopeAllowed")})})}),!t.fullScopeAllowed&&b(T,{children:[e(L,{}),e(z,{name:t.clientId,id:t.id,type:"clients",save:S,isManager:u})]})]})};function Ae(){const{adminClient:p}=C(),{t:s}=v(),r=O(),{realm:l,clientId:m}=G(),{addAlert:t,addError:f}=R(),[a,u]=D();$(()=>p.clients.findOne({id:m}),u,[]);const S=o=>V(g({realm:l,clientId:m,tab:o})),A=S("mappers"),c=S("scope");if(!a)return e(j,{});const n=async o=>{if(Array.isArray(o))try{await p.clients.addMultipleProtocolMappers({id:a.id},o),u(await p.clients.findOne({id:a.id})),t(s("mappingCreatedSuccess"),h.success)}catch(d){f("mappingCreatedError",d)}else{const d=o;r(w({realm:l,id:a.id,mapperId:d.id}))}},i=async o=>{try{await p.clients.delProtocolMapper({id:a.id,mapperId:o.id}),u({...a,protocolMappers:a.protocolMappers?.filter(d=>d.id!==o.id)}),t(s("mappingDeletedSuccess"),h.success)}catch(d){f("mappingDeletedError",d)}return!0};return b(T,{children:[e(k,{titleKey:a.clientId+"-dedicated",subKey:"dedicatedScopeExplain",divider:!1}),e(x,{variant:"light",className:"pf-v5-u-p-0",children:b(N,{isBox:!0,mountOnEnter:!0,defaultLocation:g({realm:l,clientId:m,tab:"mappers"}),children:[e(y,{title:e(M,{children:s("mappers")}),"data-testid":"mappersTab",...A,children:e(H,{model:a,onAdd:n,onDelete:i,detailLink:o=>w({realm:l,id:a.id,mapperId:o})})}),e(y,{title:e(M,{children:s("scope")}),"data-testid":"scopeTab",...c,children:e(B,{client:a})})]})})]})}export{Ae as default};
//# sourceMappingURL=DedicatedScopes-DKZHzpQC.js.map

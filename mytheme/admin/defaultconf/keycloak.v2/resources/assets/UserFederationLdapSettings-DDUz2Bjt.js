import{jsxs as M,Fragment as I,jsx as e}from"react/jsx-runtime";import{u as A,d as K,a as k,$ as x,e as B,C as E,B as U,j as R,aY as V,aP as j,h as N,L as w,s as $,f as z,c as H,aQ as O,F as Q,P as C,fk as F,fl as P}from"./main-hZIJIVx9.js";import{useState as d}from"react";import{R as Y,u as q}from"./RoutableTabs-B1siEmtL.js";import{U as G,s as J}from"./UserFederationLdapForm-Cmr2Zz5N.js";import{u as W}from"./ConfirmDialog-BClP8m2C.js";import{u as X,m as Z}from"./useLocaleSort-Cjd-LyWL.js";import{E as _}from"./ExtendedHeader-oz3wdVVK.js";import{a as T,b as D}from"./Tabs-DXjNMDMz.js";import"react-dom";import"./PageHandler-B0KkvOoM.js";import"./DynamicComponents-v6e2RtHb.js";import"./ClientSelect-9QE6UUYG.js";import"./FileUpload-DI2GSZLL.js";import"./CodeEditor-BZUGCa3z.js";import"./copy-icon-Cy7M-mD5.js";import"./GroupPickerDialog-CppD_q_3.js";import"./DataListItemRow-B1CYYhSa.js";import"./KeySelect-BUhUx10e.js";import"./useToggle-K3Kx99tM.js";import"./MultiLineInput-DThNyrNa.js";import"./AddRoleMappingModal-C4wZesy5.js";import"./translationFormatter-QNso5xUZ.js";import"./filter-icon-B5V3NoWK.js";import"./ViewHeader-DxK8RzXz.js";import"./useParams-tGf6FJmU.js";import"./PageList-DUHf6xan.js";import"./FormAccess-DIV7UK1Y.js";import"./SettingsCache-DGmyWWgw.js";import"./isEqual-BKyM3i3m.js";const ee=({toDetail:i,...o})=>e(w,{to:i(o.id),children:o.name}),te=({toCreate:i,toDetail:o})=>{const{adminClient:s}=A(),n=K(),{t:r}=k(),{addAlert:f,addError:g}=x(),[p,h]=d(0),y=()=>h(p+1),[b,S]=d([]),m=X(),{id:v}=B(),[c,l]=d();E(()=>s.components.find({parent:v,type:"org.keycloak.storage.ldap.mappers.LDAPStorageMapper"}),a=>{S(m(a.map(L=>({...L,name:L.name,type:L.providerId})),Z("name")))},[p]);const[u,t]=W({titleKey:r("deleteMappingTitle",{mapperId:c?.id}),messageKey:"deleteMappingConfirm",continueButtonLabel:"delete",continueButtonVariant:U.danger,onConfirm:async()=>{try{await s.components.del({id:c.id}),y(),f(r("mappingDeletedSuccess"),R.success),l(void 0)}catch(a){g("mappingDeletedError",a)}}});return M(I,{children:[e(t,{}),e(V,{loader:b,ariaLabelKey:"ldapMappersList",searchPlaceholderKey:"searchForMapper",toolbarItem:e(j,{children:e(N,{"data-testid":"add-mapper-btn",variant:"primary",component:a=>e(w,{...a,to:i}),children:r("addMapper")})}),actions:[{title:r("delete"),onRowClick:a=>{l(a),u()}}],columns:[{name:"name",cellRenderer:a=>e(ee,{...a,toDetail:o})},{name:"type"}],emptyState:e($,{message:r("emptyMappers"),instructions:r("emptyMappersInstructions"),primaryActionText:r("emptyPrimaryAction"),onPrimaryAction:()=>n(i)})},p)]})};function Ee(){const{adminClient:i}=A(),{t:o}=k(),s=z({mode:"onChange"}),{realm:n}=H(),{id:r}=B(),{addAlert:f,addError:g}=x(),[p,h]=d(),[y,b]=d(0),S=()=>b(t=>t+1);E(()=>i.components.findOne({id:r}),t=>{if(!t)throw new Error(o("notFound"));h(t),l(t)},[r,y]);const m=t=>q(F({realm:n,id:r,tab:t})),v=m("settings"),c=m("mappers"),l=t=>{s.reset(t),s.setValue("config.periodicChangedUsersSync",t.config?.changedSyncPeriod?.[0]!=="-1"),s.setValue("config.periodicFullSync",t.config?.fullSyncPeriod?.[0]!=="-1")},u=async t=>{try{await i.components.update({id:r},J(t)),f(o("userProviderSaveSuccess"),R.success),S()}catch(a){g("userProviderSaveError",a)}};return p?M(Q,{...s,children:[e(_,{provider:"LDAP",noDivider:!0,editMode:p.config?.editMode,save:()=>s.handleSubmit(u)()}),e(C,{variant:"light",className:"pf-v5-u-p-0",children:M(Y,{defaultLocation:F({realm:n,id:r,tab:"settings"}),isBox:!0,children:[e(T,{id:"settings",title:e(D,{children:o("settings")}),...v,children:e(C,{variant:"light",children:e(G,{id:r,onSubmit:u})})}),e(T,{id:"mappers",title:e(D,{children:o("mappers")}),"data-testid":"ldap-mappers-tab",...c,children:e(te,{toCreate:P({realm:n,id:r,mapperId:"new"}),toDetail:t=>P({realm:n,id:r,mapperId:t})})})]})})]}):e(O,{})}export{Ee as default};
//# sourceMappingURL=UserFederationLdapSettings-DDUz2Bjt.js.map

import{jsxs as d,Fragment as E,jsx as p}from"react/jsx-runtime";import{u as B,a as O,$,f as j,d as k,c as G,b as K,bw as H,bx as L,C as N,B as q,j as h,D as Q,P as R,F as U,a_ as z,b8 as _,Q as J,A as W,h as b,L as X,br as Y,by as Z,aF as ee,aE as oe}from"./main-hZIJIVx9.js";import{useState as v}from"react";import{u as te}from"./ConfirmDialog-BClP8m2C.js";import{D as ae}from"./DynamicComponents-v6e2RtHb.js";import{F as re}from"./FormAccess-DIV7UK1Y.js";import{V as pe}from"./ViewHeader-DxK8RzXz.js";import{u as ie}from"./useParams-tGf6FJmU.js";import"react-dom";import"./ClientSelect-9QE6UUYG.js";import"./FileUpload-DI2GSZLL.js";import"./CodeEditor-BZUGCa3z.js";import"./copy-icon-Cy7M-mD5.js";import"./GroupPickerDialog-CppD_q_3.js";import"./DataListItemRow-B1CYYhSa.js";import"./KeySelect-BUhUx10e.js";import"./useToggle-K3Kx99tM.js";import"./MultiLineInput-DThNyrNa.js";import"./AddRoleMappingModal-C4wZesy5.js";import"./translationFormatter-QNso5xUZ.js";import"./useLocaleSort-Cjd-LyWL.js";import"./filter-icon-B5V3NoWK.js";function Ae(){const{adminClient:i}=B(),{t:o}=O(),{addAlert:u,addError:f}=$(),{id:t,mapperId:a}=ie(),g=j(),{setValue:F,handleSubmit:S}=g,[m,C]=v(),[D,T]=v(),P=k(),{realm:y}=G(),M=K(),s=!!/^[{]?[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}[}]?$/.exec(a),c=!!H(L.path),w=()=>c?Y({realm:y,id:t,tab:"mappers"}):Z({realm:y,clientId:t,tab:"mappers"});N(async()=>{let e;if(s){if(c?e=await i.clientScopes.findProtocolMapper({id:t,mapperId:a}):e=await i.clients.findProtocolMapperById({id:t,mapperId:a}),!e)throw new Error(o("notFound"));const r=M.protocolMapperTypes[e.protocol].find(l=>l.id===e.protocolMapper);return{config:{protocol:e.protocol,protocolMapper:e.protocolMapper},mapping:r,data:e}}else{const n=c?await i.clientScopes.findOne({id:t}):await i.clients.findOne({id:t});if(!n)throw new Error(o("notFound"));const l=M.protocolMapperTypes[n.protocol].find(x=>x.id===a);if(!l)throw new Error(o("notFound"));return{mapping:l,config:{protocol:n.protocol,protocolMapper:a}}}},({config:e,mapping:n,data:r})=>{T(e),C(n),r&&oe(r,F)},[]);const[I,V]=te({titleKey:"deleteMappingTitle",messageKey:"deleteMappingConfirm",continueButtonLabel:"delete",continueButtonVariant:q.danger,onConfirm:async()=>{try{c?await i.clientScopes.delProtocolMapper({id:t,mapperId:a}):await i.clients.delProtocolMapper({id:t,mapperId:a}),u(o("mappingDeletedSuccess"),h.success),P(w())}catch(e){f("mappingDeletedError",e)}}}),A=async e=>{const n=s?"Updated":"Created";try{const r={...D,...ee(e)};s?c?await i.clientScopes.updateProtocolMapper({id:t,mapperId:a},{id:a,...r}):await i.clients.updateProtocolMapper({id:t,mapperId:a},{id:a,...r}):c?await i.clientScopes.addProtocolMapper({id:t},r):await i.clients.addProtocolMapper({id:t},r),u(o(`mapping${n}Success`),h.success)}catch(r){f(`mapping${n}Error`,r)}};return d(E,{children:[p(V,{}),p(pe,{titleKey:s?m?.name:o("addMapper"),subKey:s?a:"addMapperExplain",dropdownItems:s?[p(Q,{value:"delete",onClick:I,children:o("delete")},"delete")]:void 0}),p(R,{variant:"light",children:p(U,{...g,children:d(re,{isHorizontal:!0,onSubmit:S(A),role:"manage-clients",children:[p(z,{label:o("mapperType"),fieldId:"mapperType",children:p(_,{type:"text",id:"mapperType",name:"mapperType",readOnlyVariant:"default",value:m?.name})}),p(J,{name:"name",label:o("name"),labelIcon:o("mapperNameHelp"),readOnlyVariant:s?"default":void 0,rules:{required:{value:!0,message:o("required")}}}),p(ae,{properties:m?.properties||[],isNew:!s,stringify:!0}),d(W,{children:[p(b,{variant:"primary",type:"submit",children:o("save")}),p(b,{variant:"link",component:e=>p(X,{...e,to:w()}),children:o("cancel")})]})]})})})]})}export{Ae as default};
//# sourceMappingURL=MappingDetails-D-8sUsHp.js.map

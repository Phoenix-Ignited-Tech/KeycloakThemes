import{jsxs as c,Fragment as I,jsx as t}from"react/jsx-runtime";import{u as w,a as C,d as N,$ as z,f as F,C as k,cC as l,D as H,P as U,F as P,Q as d,A as V,h as m,B as j,L as x,j as B}from"./main-hZIJIVx9.js";import{useState as E}from"react";import{F as T}from"./FormAccess-DIV7UK1Y.js";import{V as q}from"./ViewHeader-DxK8RzXz.js";import{u as L}from"./useParams-tGf6FJmU.js";import{u as Q}from"./useToggle-K3Kx99tM.js";import{D as $}from"./DeleteScopeDialog-DSyPYHHy.js";import"react-dom";import"./copy-icon-Cy7M-mD5.js";import"./ConfirmDialog-BClP8m2C.js";function ee(){const{adminClient:n}=w(),{t:e}=C(),{id:o,scopeId:i,realm:s}=L(),p=N(),{addAlert:S,addError:v}=z(),[b,u]=Q(),[r,h]=E(),g=F({mode:"onChange"}),{reset:f,handleSubmit:y}=g;k(async()=>{if(i){const a=await n.clients.getAuthorizationScope({id:o,scopeId:i});if(!a)throw new Error(e("notFound"));return a}},a=>{h(a),f({...a})},[]);const A=async a=>{try{i?(await n.clients.updateAuthorizationScope({id:o,scopeId:i},a),h(a)):(await n.clients.createAuthorizationScope({id:o},{name:a.name,displayName:a.displayName,iconUri:a.iconUri}),p(l({realm:s,clientId:o,tab:"scopes"}))),S(e((i?"update":"create")+"ScopeSuccess"),B.success)}catch(D){v("scopeSaveError",D)}};return c(I,{children:[t($,{clientId:o,open:b,toggleDialog:u,selectedScope:r,refresh:()=>p(l({realm:s,clientId:o,tab:"scopes"}))}),t(q,{titleKey:i?r?.name:e("createAuthorizationScope"),dropdownItems:i?[t(H,{"data-testid":"delete-resource",onClick:()=>u(),children:e("delete")},"delete")]:void 0}),t(U,{variant:"light",children:t(P,{...g,children:c(T,{isHorizontal:!0,role:"manage-authorization",onSubmit:y(A),children:[t(d,{name:"name",label:e("name"),labelIcon:e("scopeNameHelp"),rules:{required:e("required")}}),t(d,{name:"displayName",label:e("displayName"),labelIcon:e("scopeDisplayNameHelp")}),t(d,{name:"iconUri",label:e("iconUri"),labelIcon:e("iconUriHelp")}),t(V,{children:c("div",{className:"pf-v5-u-mt-md",children:[t(m,{variant:j.primary,type:"submit","data-testid":"save",children:e("save")}),r?t(m,{variant:"link","data-testid":"revert",onClick:()=>f({...r}),children:e("revert")}):t(m,{variant:"link","data-testid":"cancel",component:a=>t(x,{...a,to:l({realm:s,clientId:o,tab:"scopes"})}),children:e("cancel")})]})})]})})})]})}export{ee as default};
//# sourceMappingURL=ScopeDetails-DqQhj2b0.js.map

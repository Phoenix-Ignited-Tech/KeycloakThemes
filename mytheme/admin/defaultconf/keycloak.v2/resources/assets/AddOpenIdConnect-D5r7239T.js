import{jsxs as d,Fragment as v,jsx as e}from"react/jsx-runtime";import{u as h,a as g,b5 as C,T as P,a_ as b,a$ as S,bc as k,d as D,dv as E,f as O,$ as A,c as x,P as w,F as $,A as L,h as f,L as T,dH as U,j as V,dI as j}from"./main-hZIJIVx9.js";import{F as H}from"./FormAccess-DIV7UK1Y.js";import{V as G}from"./ViewHeader-DxK8RzXz.js";import{D as J,O as K,a as N}from"./OIDCGeneralSettings-CZaDmNgJ.js";import{J as _}from"./JsonFileUpload-C00oYgkL.js";import{D as z}from"./DiscoveryEndpointField-DY5MpVbr.js";import"react";import"react-dom";import"./copy-icon-Cy7M-mD5.js";import"./SwitchControl-CuqH9Ng4.js";/* empty css                           */import"./ExpandableSection-BHMIrvCp.js";import"./ClientIdSecret-KRPFh3sV.js";import"./RedirectUrl-DLJV9Xtv.js";import"./FileUploadForm-Tqz1ZjTZ.js";import"./FileUpload-DI2GSZLL.js";import"./CodeEditor-BZUGCa3z.js";const B=()=>{const{adminClient:l}=h(),{t}=g(),m="oidc",{setValue:p,setError:c,clearErrors:n,formState:{errors:o}}=C(),u=r=>{Object.keys(r).map(i=>p(`config.${i}`,r[i]))},y=async r=>{if(n("discoveryError"),!r)return;const i=new FormData;i.append("providerId",m),i.append("file",new Blob([JSON.stringify(r)]));try{const a=await l.identityProviders.importFromUrl(i);u(a)}catch(a){c("discoveryError",{type:"manual",message:a.message})}};return d(v,{children:[e(P,{headingLevel:"h2",size:"xl",className:"kc-form-panel__title",children:t("oidcSettings")}),e(z,{id:"oidc",fileUpload:d(b,{label:t("importConfig"),fieldId:"kc-import-config",labelIcon:e(S,{helpText:t("importConfigHelp"),fieldLabelId:"importConfig"}),children:[e(_,{id:"kc-import-config",helpText:t("identity=providers-help:jsonFileUpload"),hideDefaultPreview:!0,unWrap:!0,validated:o.discoveryError?"error":"default",onChange:r=>y(r)}),o.discoveryError&&e(k,{message:o.discoveryError.message})]}),children:r=>e(J,{readOnly:r})})]})};function le(){const{adminClient:l}=h(),{t}=g(),m=D(),{pathname:p}=E(),c=p.includes("keycloak-oidc"),n=`${c?"keycloak-":""}oidc`,o=O({defaultValues:{alias:n},mode:"onChange"}),{handleSubmit:u,formState:{isDirty:y}}=o,{addAlert:r,addError:i}=A(),{realm:a}=x(),I=async s=>{delete s.discoveryEndpoint;try{await l.identityProviders.create({...s,providerId:n}),r(t("createIdentityProviderSuccess"),V.success),m(j({realm:a,providerId:n,alias:s.alias,tab:"settings"}))}catch(F){i("createIdentityProviderError",F)}};return d(v,{children:[e(G,{titleKey:t(c?"addKeycloakOpenIdProvider":"addOpenIdProvider")}),e(w,{variant:"light",children:e($,{...o,children:d(H,{role:"manage-identity-providers",isHorizontal:!0,onSubmit:u(I),children:[e(K,{}),e(B,{}),e(N,{}),d(L,{children:[e(f,{isDisabled:!y,variant:"primary",type:"submit","data-testid":"createProvider",children:t("add")}),e(f,{variant:"link","data-testid":"cancel",component:s=>e(T,{...s,to:U({realm:a})}),children:t("cancel")})]})]})})})]})}export{le as default};
//# sourceMappingURL=AddOpenIdConnect-D5r7239T.js.map

import{jsx as e,jsxs as m,Fragment as I}from"react/jsx-runtime";import{u as V,a as k,d as B,f as T,c as x,$ as E,C as K,aZ as L,B as $,bL as v,aQ as j,D as H,P as N,F as O,Q as P,A as Q,h as C,L as q,bM as U}from"./main-hZIJIVx9.js";import{useState as z}from"react";import{u as G}from"./ConfirmDialog-BClP8m2C.js";import{D as M}from"./DynamicComponents-v6e2RtHb.js";import{F as W}from"./FormAccess-DIV7UK1Y.js";import{V as Z}from"./ViewHeader-DxK8RzXz.js";import{u as J}from"./useParams-tGf6FJmU.js";import"react-dom";import"./ClientSelect-9QE6UUYG.js";import"./FileUpload-DI2GSZLL.js";import"./CodeEditor-BZUGCa3z.js";import"./copy-icon-Cy7M-mD5.js";import"./GroupPickerDialog-CppD_q_3.js";import"./DataListItemRow-B1CYYhSa.js";import"./KeySelect-BUhUx10e.js";import"./useToggle-K3Kx99tM.js";import"./MultiLineInput-DThNyrNa.js";import"./AddRoleMappingModal-C4wZesy5.js";import"./translationFormatter-QNso5xUZ.js";import"./useLocaleSort-Cjd-LyWL.js";import"./filter-icon-B5V3NoWK.js";function Ce(){const{adminClient:n}=V(),{t}=k(),{id:r,providerId:s,subTab:c}=J(),d=B(),p=T({defaultValues:{providerId:s}}),{control:b,handleSubmit:h,reset:D}=p,{realm:l,realmRepresentation:R}=x(),{addAlert:u,addError:f}=E(),[g,w]=z();K(async()=>await Promise.all([n.realms.getClientRegistrationPolicyProviders({realm:l}),r?n.components.findOne({id:r}):Promise.resolve()]),([i,o])=>{w(i.find(a=>a.id===s)),D(o||{providerId:s})},[]);const y=L({control:b,defaultValue:"",name:"name"}),A=async i=>{i.config&&Object.entries(i.config).forEach(([o,a])=>i.config[o]=Array.isArray(a)?a:[a]);try{const o={...i,subType:c,parentId:R?.id,providerType:"org.keycloak.services.clientregistration.policy.ClientRegistrationPolicy",providerId:s};if(r)await n.components.update({id:r},o);else{const{id:a}=await n.components.create(o);d(U({id:a,realm:l,subTab:c,providerId:s}))}u(t(`provider${r?"Updated":"Create"}Success`))}catch(o){f(`provider${r?"Updated":"Create"}Error`,o)}},[S,F]=G({titleKey:"clientRegisterPolicyDeleteConfirmTitle",messageKey:t("clientRegisterPolicyDeleteConfirm",{name:y}),continueButtonLabel:"delete",continueButtonVariant:$.danger,onConfirm:async()=>{try{await n.components.del({realm:l,id:r}),u(t("clientRegisterPolicyDeleteSuccess")),d(v({realm:l,subTab:c}))}catch(i){f("clientRegisterPolicyDeleteError",i)}}});return g?m(I,{children:[e(Z,{titleKey:r?y:"createPolicy",subKey:r,dropdownItems:r?[e(H,{"data-testid":"delete",onClick:S,children:t("delete")},"delete")]:void 0}),e(F,{}),e(N,{variant:"light",children:e(O,{...p,children:m(W,{role:"manage-clients",isHorizontal:!0,onSubmit:h(A),children:[e(P,{name:"providerId",label:t("provider"),readOnly:!0}),e(P,{name:"name",label:t("name"),labelIcon:t("clientPolicyNameHelp"),rules:{required:t("required")}}),e(M,{properties:g.properties}),m(Q,{children:[e(C,{"data-testid":"save",type:"submit",children:t("save")}),e(C,{variant:"link",component:i=>e(q,{...i,to:v({realm:l,subTab:c})}),children:t("cancel")})]})]})})})]}):e(j,{})}export{Ce as default};
//# sourceMappingURL=DetailProvider-BiVu4HmM.js.map

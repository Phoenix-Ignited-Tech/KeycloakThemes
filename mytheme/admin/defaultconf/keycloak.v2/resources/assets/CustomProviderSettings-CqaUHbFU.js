import{jsxs as l,jsx as e}from"react/jsx-runtime";import{a as I,b5 as N,F as U,a_ as b,a$ as v,b0 as P,aR as C,Q as f,u as V,d as x,f as H,$ as _,c as j,b as D,C as O,P as L,A as $,h as F,L as R,eZ as k,aF as z,j as G,aE as Q}from"./main-hZIJIVx9.js";import{D as q}from"./DynamicComponents-v6e2RtHb.js";import{F as B}from"./FormAccess-DIV7UK1Y.js";import{u as W}from"./useParams-tGf6FJmU.js";import{E as Z}from"./ExtendedHeader-oz3wdVVK.js";import{S as J}from"./SettingsCache-DGmyWWgw.js";import"react";import"react-dom";import"./ClientSelect-9QE6UUYG.js";import"./FileUpload-DI2GSZLL.js";import"./CodeEditor-BZUGCa3z.js";import"./copy-icon-Cy7M-mD5.js";import"./GroupPickerDialog-CppD_q_3.js";import"./DataListItemRow-B1CYYhSa.js";import"./KeySelect-BUhUx10e.js";import"./useToggle-K3Kx99tM.js";import"./MultiLineInput-DThNyrNa.js";import"./AddRoleMappingModal-C4wZesy5.js";import"./translationFormatter-QNso5xUZ.js";import"./useLocaleSort-Cjd-LyWL.js";import"./ConfirmDialog-BClP8m2C.js";import"./filter-icon-B5V3NoWK.js";import"./ViewHeader-DxK8RzXz.js";import"./isEqual-BKyM3i3m.js";const K=()=>{const{t:r}=I(),a=N(),{control:o,watch:t}=a,d=t("config.fullSyncPeriod","-1"),c=t("config.changedSyncPeriod","-1");return l(U,{...a,children:[e(b,{label:r("periodicFullSync"),labelIcon:e(v,{helpText:r("periodicFullSyncHelp"),fieldLabelId:"periodicFullSync"}),fieldId:"kc-periodic-full-sync",hasNoPaddingTop:!0,children:e(P,{name:"config.fullSyncPeriod",defaultValue:"-1",control:o,render:({field:i})=>e(C,{id:"kc-periodic-full-sync","data-testid":"periodic-full-sync",onChange:(m,s)=>{i.onChange(s?"604800":"-1")},isChecked:i.value!=="-1",label:r("on"),labelOff:r("off"),"aria-label":r("periodicFullSync")})})}),d!=="-1"&&e(f,{name:"config.fullSyncPeriod",label:r("fullSyncPeriod"),labelIcon:r("fullSyncPeriodHelp"),type:"number",min:-1,defaultValue:"604800"}),e(b,{label:r("periodicChangedUsersSync"),labelIcon:e(v,{helpText:r("periodicChangedUsersSyncHelp"),fieldLabelId:"periodicChangedUsersSync"}),fieldId:"kc-periodic-changed-users-sync",hasNoPaddingTop:!0,children:e(P,{name:"config.changedSyncPeriod",defaultValue:"-1",control:o,render:({field:i})=>e(C,{id:"kc-periodic-changed-users-sync","data-testid":"periodic-changed-users-sync",onChange:(m,s)=>{i.onChange(s?"86400":"-1")},isChecked:i.value!=="-1",label:r("on"),labelOff:r("off"),"aria-label":r("periodicChangedUsersSync")})})}),c!=="-1"&&e(f,{name:"config.changedSyncPeriod",label:r("changedUsersSyncPeriod"),labelIcon:r("changedUsersSyncHelp"),type:"number",min:-1,defaultValue:"86400"})]})};function Ce(){const{adminClient:r}=V(),{t:a}=I(),{id:o,providerId:t}=W(),d=x(),c=H({mode:"onChange"}),{reset:i,setValue:m,handleSubmit:s,formState:{isDirty:w}}=c,{addAlert:T,addError:A}=_(),{realm:y,realmRepresentation:E}=j(),h=(D().componentTypes?.["org.keycloak.storage.UserStorageProvider"]||[]).find(n=>n.id===t);O(async()=>{if(o)return await r.components.findOne({id:o})},n=>{if(n)Q(n,m);else if(o)throw new Error(a("notFound"))},[]);const g=async n=>{const S=z({...n,config:Object.fromEntries(Object.entries(n.config||{}).map(([p,u])=>[p,Array.isArray(u)?u:[u]])),providerId:t,providerType:"org.keycloak.storage.UserStorageProvider",parentId:E?.id});try{o?await r.components.update({id:o},S):(await r.components.create(S),d(k({realm:y}))),i({...n}),T(a(o?"userProviderSaveSuccess":"createUserProviderSuccess"),G.success)}catch(p){A(o?"userProviderSaveError":"createUserProviderError",p)}};return l(U,{...c,children:[e(Z,{provider:t,save:()=>s(g)()}),e(L,{variant:"light",children:l(B,{role:"manage-realm",isHorizontal:!0,className:"keycloak__user-federation__custom-form",onSubmit:s(g),children:[e(f,{name:"name",label:a("uiDisplayName"),labelIcon:a("uiDisplayNameHelp"),rules:{required:a("validateName")}}),e(q,{properties:h?.properties||[]}),h?.metadata.synchronizable&&e(K,{}),e(J,{form:c,unWrap:!0}),l($,{children:[e(F,{isDisabled:!w,variant:"primary",type:"submit","data-testid":"custom-save",children:a("save")}),e(F,{variant:"link",component:n=>e(R,{...n,to:k({realm:y})}),"data-testid":"custom-cancel",children:a("cancel")})]})]})})]})}export{Ce as default};
//# sourceMappingURL=CustomProviderSettings-CqaUHbFU.js.map
